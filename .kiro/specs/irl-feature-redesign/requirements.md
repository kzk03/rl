# 逆強化学習特徴量見直し - 要件定義書

## 概要

現在の Kazoo プロジェクトの逆強化学習（IRL）コンポーネントで使用している特徴量を見直し、より効果的な開発者-タスクマッチングを実現するための特徴量設計を改善する。現在の特徴量には冗長性や不適切な設計が含まれている可能性があり、特徴量の選択・設計・組み合わせを最適化する必要がある。

## 現在の特徴量構成

### タスク関連特徴量（4 次元）

- `task_days_since_last_activity`: 最後の活動からの日数
- `task_discussion_activity`: ディスカッション活動量
- `task_text_length`: タスクテキストの長さ
- `task_code_block_count`: コードブロック数

### タスクラベル特徴量（5 次元）

- `task_label_bug`, `task_label_enhancement`, `task_label_documentation`, `task_label_question`, `task_label_help wanted`

### 開発者基本特徴量（3 次元）

- `dev_recent_activity_count`: 最近の活動数
- `dev_current_workload`: 現在のワークロード
- `dev_total_lines_changed`: 総変更行数

### 開発者社会的特徴量（3 次元）

- `dev_collaboration_network_size`: 協力ネットワークサイズ
- `dev_comment_interactions`: コメント相互作用数
- `dev_cross_issue_activity`: クロスイシュー活動

### マッチング特徴量（8 次元）

- `match_collaborated_with_task_author`: タスク作成者との協力履歴
- `match_collaborator_overlap_count`: 協力者重複数
- `match_has_prior_collaboration`: 事前協力履歴の有無
- `match_skill_intersection_count`: スキル交差数
- `match_file_experience_count`: ファイル経験数
- `match_affinity_for_*`: 各ラベルに対する親和性（5 次元）

### GAT 特徴量（37 次元）

- グラフアテンションネットワークから抽出された協力関係埋め込み

## 要件

### 要件 1: 特徴量の有効性分析

**ユーザーストーリー:** データサイエンティストとして、現在の特徴量の有効性を定量的に評価したいので、各特徴量の貢献度と相関関係を分析できるようにしたい

#### 受入基準

1. WHEN 特徴量分析が実行される THEN システムは各特徴量の重要度を計算する SHALL

   - IRL 学習後の重みの絶対値による重要度ランキング
   - 特徴量カテゴリ別の平均重要度比較
   - 統計的有意性の検証

2. WHEN 特徴量間の関係を分析する THEN システムは相関分析を実行する SHALL

   - 特徴量間のピアソン相関係数計算
   - 高相関特徴量ペアの特定（|r| > 0.8）
   - 冗長な特徴量の候補リスト作成

3. WHEN 特徴量の分布を確認する THEN システムは分布特性を分析する SHALL
   - 各特徴量の分布形状（正規性、歪度、尖度）
   - 外れ値の検出と影響評価
   - スケールの不均衡問題の特定

### 要件 2: 特徴量設計の改善

**ユーザーストーリー:** 機械学習エンジニアとして、より効果的な特徴量設計を実装したいので、新しい特徴量の提案と既存特徴量の改良を行いたい

#### 受入基準

1. WHEN タスク特徴量を改善する THEN システムは以下の新特徴量を提供する SHALL

   - タスクの緊急度指標（優先度ラベル、期限情報）
   - タスクの複雑度指標（説明文の技術用語密度、参照リンク数）
   - タスクの社会的注目度（ウォッチャー数、リアクション数）

2. WHEN 開発者特徴量を改善する THEN システムは以下の新特徴量を提供する SHALL

   - 開発者の専門性指標（主要言語、ドメイン専門性）
   - 開発者の活動パターン（時間帯、曜日の活動傾向）
   - 開発者の成果品質（過去の PR のマージ率、レビュー評価）

3. WHEN マッチング特徴量を改善する THEN システムは以下の新特徴量を提供する SHALL
   - 時間的近接性（最近の協力時期、活動時間の重複）
   - 技術的適合性（使用技術スタックの一致度）
   - 成功履歴（過去の協力成果、完了率）

### 要件 3: 特徴量の正規化・スケーリング

**ユーザーストーリー:** MLOps エンジニアとして、特徴量のスケールの違いによる学習への悪影響を防ぎたいので、適切な正規化・スケーリング手法を適用したい

#### 受入基準

1. WHEN 数値特徴量を処理する THEN システムは適切なスケーリングを適用する SHALL

   - 対数変換が必要な特徴量の特定（行数、フォロワー数等）
   - 標準化（z-score）または min-max 正規化の選択
   - カテゴリ別スケーリング戦略の適用

2. WHEN カテゴリカル特徴量を処理する THEN システムは適切なエンコーディングを適用する SHALL

   - ワンホットエンコーディングの最適化
   - 順序カテゴリの適切な数値化
   - 高カーディナリティカテゴリの処理

3. WHEN 時系列特徴量を処理する THEN システムは時間的特性を考慮する SHALL
   - 相対時間への変換（絶対時間から経過時間へ）
   - 周期性の考慮（曜日、時間帯）
   - 時間窓の最適化

### 要件 4: 特徴量選択・次元削減

**ユーザーストーリー:** 研究者として、最も効果的な特徴量サブセットを特定したいので、統計的手法による特徴量選択を実行したい

#### 受入基準

1. WHEN 特徴量選択を実行する THEN システムは複数の手法を提供する SHALL

   - 単変量統計検定による選択（chi-square, ANOVA）
   - 再帰的特徴量除去（RFE）
   - L1 正則化による自動選択

2. WHEN 次元削減を実行する THEN システムは以下の手法を提供する SHALL

   - 主成分分析（PCA）による線形次元削減
   - t-SNE または UMAP による非線形次元削減
   - 特徴量重要度に基づく選択的削減

3. WHEN 特徴量の組み合わせを最適化する THEN システムは相互作用を考慮する SHALL
   - 特徴量間の相互作用項の生成
   - 多項式特徴量の生成と評価
   - 最適な特徴量組み合わせの探索

### 要件 5: GAT 特徴量の最適化

**ユーザーストーリー:** グラフ機械学習の専門家として、GAT 特徴量の品質と解釈可能性を向上させたいので、GAT 特徴量の分析と最適化を行いたい

#### 受入基準

1. WHEN GAT 特徴量を分析する THEN システムは埋め込み品質を評価する SHALL

   - GAT 特徴量の分散と情報量の測定
   - クラスタリング品質の評価
   - 基本特徴量との相関分析

2. WHEN GAT 特徴量を最適化する THEN システムは以下の改善を提供する SHALL

   - GAT 特徴量の次元数最適化
   - アテンション重みの可視化と解釈
   - グラフ構造の影響分析

3. WHEN GAT 特徴量の解釈性を向上させる THEN システムは説明機能を提供する SHALL
   - 各 GAT 次元の意味解釈
   - 重要なグラフパターンの特定
   - 協力関係の可視化

### 要件 6: 特徴量エンジニアリングの自動化

**ユーザーストーリー:** システム管理者として、特徴量エンジニアリングプロセスを自動化したいので、設定可能な特徴量生成パイプラインを構築したい

#### 受入基準

1. WHEN 特徴量生成を自動化する THEN システムは設定駆動の生成を提供する SHALL

   - YAML 設定による特徴量選択
   - 動的な特徴量組み合わせ生成
   - A/B テスト用の特徴量セット管理

2. WHEN 特徴量品質を監視する THEN システムは品質メトリクスを提供する SHALL

   - 特徴量の欠損率監視
   - 分布ドリフトの検出
   - 特徴量重要度の変化追跡

3. WHEN 新しい特徴量を評価する THEN システムは自動評価を実行する SHALL
   - 新特徴量の予測性能への影響測定
   - 統計的有意性の自動検証
   - 最適特徴量セットの自動選択
