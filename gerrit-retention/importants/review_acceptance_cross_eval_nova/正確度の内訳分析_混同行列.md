# 正確度の内訳分析 - 混同行列による詳細調査

## 📊 ユーザーの仮説

> 「正確度が高い」=「負例をたくさん当てているから」という説

この仮説を検証するため、混同行列を用いて正確度の内訳を詳細に分析しました。

---

## 🔍 混同行列の見方

```
        予測: 負例  予測: 正例
実際: 負例    TN       FN
実際: 正例    FP       TP

TN (True Negative):  真の負例 → 予測負例 ✅
FP (False Positive): 真の正例 → 予測負例 ❌
FN (False Negative): 真の負例 → 予測正例 ❌
TP (True Positive):  真の正例 → 予測正例 ✅

正確度 = (TN + TP) / Total
```

---

## 📈 消極的な開発者（受諾率 < 10%）の詳細

### 0-3m 期間

| 項目                         | 数  | 割合      |
| ---------------------------- | --- | --------- |
| **総サンプル数**             | 27  | 100%      |
| **TN (真の負例 → 予測負例)** | 15  | **55.6%** |
| **FP (真の正例 → 予測負例)** | 8   | 29.6%     |
| **FN (真の負例 → 予測正例)** | 1   | 3.7%      |
| **TP (真の正例 → 予測正例)** | 3   | 11.1%     |

```
正確度 = (15 + 3) / 27 = 0.667
```

**解釈:**

- 消極的な開発者の 85.2%が実際に負例（離脱）
- そのうち 15 人（55.6%）を正しく負例と予測（TN）
- → **TN が正確度を押し上げている**

### 3-6m 期間

| 項目                         | 数  | 割合      |
| ---------------------------- | --- | --------- |
| **総サンプル数**             | 32  | 100%      |
| **TN (真の負例 → 予測負例)** | 24  | **75.0%** |
| **FP (真の正例 → 予測負例)** | 3   | 9.4%      |
| **FN (真の負例 → 予測正例)** | 2   | 6.2%      |
| **TP (真の正例 → 予測正例)** | 3   | 9.4%      |

```
正確度 = (24 + 3) / 32 = 0.844
```

**解釈:**

- 消極的な開発者の 84.4%が実際に負例（離脱）
- そのうち 24 人（75.0%）を正しく負例と予測（TN）
- → **最も高い正確度：84.4%**

### 6-9m 期間

| 項目                         | 数  | 割合      |
| ---------------------------- | --- | --------- |
| **総サンプル数**             | 21  | 100%      |
| **TN (真の負例 → 予測負例)** | 12  | **57.1%** |
| **FP (真の正例 → 予測負例)** | 7   | 33.3%     |
| **FN (真の負例 → 予測正例)** | 0   | 0.0%      |
| **TP (真の正例 → 予測正例)** | 2   | 9.5%      |

```
正確度 = (12 + 2) / 21 = 0.667
```

**解釈:**

- 消極的な開発者の 90.5%が実際に負例（離脱）
- そのうち 12 人（57.1%）を正しく負例と予測（TN）
- FN=0 → 負例を正例と誤って予測していない

---

## 📊 積極的な開発者（受諾率 ≥ 25%）の詳細

### 0-3m 期間

| 項目                         | 数  | 割合      |
| ---------------------------- | --- | --------- |
| **総サンプル数**             | 9   | 100%      |
| **TN (真の負例 → 予測負例)** | 0   | 0.0%      |
| **FP (真の正例 → 予測負例)** | 0   | 0.0%      |
| **FN (真の負例 → 予測正例)** | 5   | **55.6%** |
| **TP (真の正例 → 予測正例)** | 4   | 44.4%     |

```
正確度 = (0 + 4) / 9 = 0.444
```

**解釈:**

- 積極的な開発者の 100%が実際に正例（継続）
- しかし、そのうち 5 人（55.6%）を負例と誤って予測（FN）
- → **正例を正例と予測できていない**

### 3-6m 期間

| 項目                         | 数  | 割合      |
| ---------------------------- | --- | --------- |
| **総サンプル数**             | 6   | 100%      |
| **TN (真の負例 → 予測負例)** | 0   | 0.0%      |
| **FP (真の正例 → 予測負例)** | 0   | 0.0%      |
| **FN (真の負例 → 予測正例)** | 4   | **66.7%** |
| **TP (真の正例 → 予測正例)** | 2   | 33.3%     |

```
正確度 = (0 + 2) / 6 = 0.333
```

**解釈:**

- 積極的な開発者の 100%が実際に正例（継続）
- そのうち 4 人（66.7%）を負例と誤って予測（FN）
- → **最も低い正確度：33.3%**

### 6-9m 期間

| 項目                         | 数  | 割合      |
| ---------------------------- | --- | --------- |
| **総サンプル数**             | 3   | 100%      |
| **TN (真の負例 → 予測負例)** | 0   | 0.0%      |
| **FP (真の正例 → 予測負例)** | 0   | 0.0%      |
| **FN (真の負例 → 予測正例)** | 2   | **66.7%** |
| **TP (真の正例 → 予測正例)** | 1   | 33.3%     |

```
正確度 = (0 + 1) / 3 = 0.333
```

**解釈:**

- 積極的な開発者の 100%が実際に正例（継続）
- そのうち 2 人（66.7%）を負例と誤って予測（FN）
- → **低い正確度：33.3%**

---

## 🎯 結論

### 消極的な開発者

✅ **ユーザーの仮説が正しい！**

- **正確度が高い理由:** 負例をたくさん当てているから
- **TN（真の負例 → 予測負例）が大きい**
  - 0-3m: 15 人（55.6%）
  - 3-6m: 24 人（75.0%）
  - 6-9m: 12 人（57.1%）
- **これは実際に良い予測**
  - 消極的な開発者が離脱することを正しく予測できている
  - 逆強化学習が「消極的 = 負例」というパターンを学習

### 積極的な開発者

⚠️ **問題がある**

- **正確度が低い理由:** 正例を負例と誤って予測しているから
- **FN（真の負例 → 予測正例）が多い**
  - 0-3m: 5 人（55.6%）
  - 3-6m: 4 人（66.7%）
  - 6-9m: 2 人（66.7%）
- **根本原因**
  - 正例が 100%なのに、予測で負例と判断してしまう
  - **予測確率の分散が小さい**ことが原因
  - モデルが「全体的に負例寄り」に予測している

---

## 📋 まとめ

| 開発者タイプ | 分布           | 正確度            | 主な寄与要素 | 解釈                  |
| ------------ | -------------- | ----------------- | ------------ | --------------------- |
| **消極的**   | 多い (60-80%)  | **高い** (67-84%) | TN が多い    | ✅ 負例を正しく予測   |
| **積極的**   | 少ない (5-20%) | **低い** (33-44%) | FN が多い    | ❌ 正例を負例と誤予測 |

### 重要な洞察

1. **消極的な開発者の高正確度は「良いサイン」**

   - 負例の大部分を正しく予測できている
   - モデルが「離脱パターン」を学習している証拠

2. **積極的な開発者の低正確度は「課題」**

   - 正例を正例と予測できていない
   - 予測確率の分散を改善する必要がある

3. **分布が多いからといって予測が簡単ではない**
   - 消極的な開発者は多いが、正しく予測できている
   - 積極的な開発者は少ないが、予測が困難

---

## 📄 関連ファイル

- `passive_developer_comprehensive_analysis.png`: 分布と正確度の統合可視化
- `confusion_matrix_detail.png`: 混同行列の詳細可視化
- `developer_3class_performance.png`: 正確度の推移グラフ
