# è¨“ç·´ãƒ‡ãƒ¼ã‚¿ vs ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿æ€§èƒ½è©•ä¾¡

**ä½œæˆæ—¥**: 2025-11-17
**ç›®çš„**: éå­¦ç¿’æ¤œè¨¼ã¨å ±é…¬é–¢æ•°ã®å¦¥å½“æ€§ç¢ºèª

---

## ğŸ¯ ãªãœä¸¡æ–¹ã‚’è©•ä¾¡ã™ã‚‹ã®ã‹ï¼Ÿ

### æ©Ÿæ¢°å­¦ç¿’ã®åŸºæœ¬åŸå‰‡

```
è¨“ç·´ãƒ‡ãƒ¼ã‚¿æ€§èƒ½ï¼ˆTraining Performanceï¼‰
  ç›®çš„: ãƒ¢ãƒ‡ãƒ«ãŒè¨“ç·´ãƒ‡ãƒ¼ã‚¿ã‚’ã©ã‚Œã ã‘å­¦ç¿’ã—ãŸã‹
  é‡è¦æ€§: å­¦ç¿’ã®åŸºç¤ç¢ºèª

ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿æ€§èƒ½ï¼ˆTest Performanceï¼‰
  ç›®çš„: æœªçŸ¥ãƒ‡ãƒ¼ã‚¿ã¸ã®æ±åŒ–æ€§èƒ½
  é‡è¦æ€§: å®Ÿç”¨æ€§ã®è¨¼æ˜
```

### IRLç‰¹æœ‰ã®é‡è¦æ€§

**IRLï¼ˆé€†å¼·åŒ–å­¦ç¿’ï¼‰ã®æ ¸å¿ƒçš„ãªå•ã„**:
> ã€Œç¶™ç¶šã—ãŸé–‹ç™ºè€…ã®è¡Œå‹•ãƒ‘ã‚¿ãƒ¼ãƒ³ã‹ã‚‰ã€æ­£ã—ãå ±é…¬é–¢æ•°ã‚’å­¦ç¿’ã§ãã¦ã„ã‚‹ã‹ï¼Ÿã€

**æ¤œè¨¼ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ**:

1. **è¨“ç·´ãƒ‡ãƒ¼ã‚¿ã§è©•ä¾¡** â†’ å ±é…¬é–¢æ•°ãŒè¨“ç·´ãƒ‡ãƒ¼ã‚¿ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’æ‰ãˆã¦ã„ã‚‹ã‹
2. **ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã§è©•ä¾¡** â†’ å­¦ç¿’ã—ãŸå ±é…¬é–¢æ•°ãŒæ–°ã—ã„ãƒ‡ãƒ¼ã‚¿ã«æ±åŒ–ã™ã‚‹ã‹

---

## ğŸ“Š è©•ä¾¡ãƒ‘ã‚¿ãƒ¼ãƒ³ã®æ•´ç†

### ãƒ‘ã‚¿ãƒ¼ãƒ³1: è¨“ç·´ãƒ‡ãƒ¼ã‚¿è©•ä¾¡ï¼ˆæ„å›³çš„ãªãƒ‡ãƒ¼ã‚¿ãƒªãƒ¼ã‚¯ï¼‰

**ç›®çš„**: éå­¦ç¿’æ¤œè¨¼ã€å ±é…¬é–¢æ•°ã®å¦¥å½“æ€§ç¢ºèª

```
ãƒ‡ãƒ¼ã‚¿: è¨“ç·´æœŸé–“ã®ãƒ‡ãƒ¼ã‚¿ï¼ˆ2021-01 ï½ 2023-01ï¼‰
ç‰¹å¾´é‡: è¨“ç·´æœŸé–“ã®æ´»å‹•
ãƒ©ãƒ™ãƒ«: è¨“ç·´æœŸé–“å†…ã®å°†æ¥çª“
è©•ä¾¡: è¨“ç·´ãƒ‡ãƒ¼ã‚¿ã§ã®å†ç¾æ€§

âš ï¸ ã“ã‚Œã¯ã€Œãƒ‡ãƒ¼ã‚¿ãƒªãƒ¼ã‚¯ã€ã ãŒæ„å›³çš„
ç›®çš„: ãƒ¢ãƒ‡ãƒ«ãŒè¨“ç·´ãƒ‡ãƒ¼ã‚¿ã‚’æ­£ã—ãå­¦ç¿’ã—ãŸã‹ç¢ºèª
```

**å®Ÿè£…**:
```python
# è¨“ç·´ãƒ‡ãƒ¼ã‚¿ã§å†è©•ä¾¡
train_trajectories = extract_trajectories(
    df,
    train_start="2021-01-01",
    train_end="2023-01-01",
    future_window="0-3m"
)

# è¨“ç·´
model.train(train_trajectories)

# è¨“ç·´ãƒ‡ãƒ¼ã‚¿ã§æ€§èƒ½è©•ä¾¡
train_predictions = model.predict(train_trajectories)
train_auc = compute_auc(train_predictions, train_labels)

print(f"è¨“ç·´ãƒ‡ãƒ¼ã‚¿AUC-ROC: {train_auc:.3f}")
# æœŸå¾…: 0.9ä»¥ä¸Šï¼ˆé«˜ã‘ã‚Œã°å­¦ç¿’æˆåŠŸï¼‰
```

**è§£é‡ˆ**:

| è¨“ç·´AUC | æ„å‘³ |
|---------|------|
| **0.95+** | å®Œç’§ãªå­¦ç¿’ã€å ±é…¬é–¢æ•°ãŒè¨“ç·´ãƒ‡ãƒ¼ã‚¿ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’å®Œå…¨ã«æ‰ãˆã¦ã„ã‚‹ |
| **0.85-0.95** | è‰¯å¥½ãªå­¦ç¿’ã€å ±é…¬é–¢æ•°ãŒä¸»è¦ãªãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’å­¦ç¿’ |
| **0.70-0.85** | ä¸­ç¨‹åº¦ã®å­¦ç¿’ã€æ”¹å–„ã®ä½™åœ°ã‚ã‚Š |
| **<0.70** | å­¦ç¿’å¤±æ•—ã€ãƒ¢ãƒ‡ãƒ«/ç‰¹å¾´é‡ã«å•é¡Œ |

---

### ãƒ‘ã‚¿ãƒ¼ãƒ³2: ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿è©•ä¾¡ï¼ˆçœŸã®æ±åŒ–æ€§èƒ½ï¼‰

**ç›®çš„**: æœªçŸ¥ãƒ‡ãƒ¼ã‚¿ã¸ã®æ±åŒ–æ€§èƒ½æ¸¬å®š

```
ãƒ‡ãƒ¼ã‚¿: è©•ä¾¡æœŸé–“ã®ãƒ‡ãƒ¼ã‚¿ï¼ˆ2023-01-01ä»¥é™ï¼‰
ç‰¹å¾´é‡: Cutoffæ—¥ã¾ã§ã®æ´»å‹•
ãƒ©ãƒ™ãƒ«: Cutoffæ—¥ä»¥é™ã®å°†æ¥çª“
è©•ä¾¡: çœŸã®æ±åŒ–æ€§èƒ½

âœ“ ãƒ‡ãƒ¼ã‚¿ãƒªãƒ¼ã‚¯ãªã—
ç›®çš„: å®Ÿç”¨æ€§ã®è¨¼æ˜
```

**å®Ÿè£…**:
```python
# ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã§è©•ä¾¡
test_trajectories = extract_evaluation_trajectories(
    df,
    cutoff_date="2023-01-01",
    history_window_months=12,
    future_window_start=6,
    future_window_end=9
)

# è¨“ç·´æ¸ˆã¿ãƒ¢ãƒ‡ãƒ«ã§äºˆæ¸¬
test_predictions = model.predict(test_trajectories)
test_auc = compute_auc(test_predictions, test_labels)

print(f"ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿AUC-ROC: {test_auc:.3f}")
# æœŸå¾…: è¨“ç·´AUCã«è¿‘ã„å€¤ï¼ˆæ±åŒ–æ€§èƒ½ï¼‰
```

**è§£é‡ˆ**:

| ãƒ†ã‚¹ãƒˆAUC | æ„å‘³ |
|-----------|------|
| **0.90+** | å„ªç§€ãªæ±åŒ–æ€§èƒ½ã€å®Ÿç”¨ãƒ¬ãƒ™ãƒ« |
| **0.80-0.90** | è‰¯å¥½ãªæ±åŒ–æ€§èƒ½ |
| **0.70-0.80** | å®Ÿç”¨å¯èƒ½ãƒ¬ãƒ™ãƒ« |
| **<0.70** | æ±åŒ–æ€§èƒ½ä¸è¶³ |

---

## ğŸ”¬ éå­¦ç¿’ã®è¨ºæ–­

### 4ã¤ã®ã‚·ãƒŠãƒªã‚ª

#### ã‚·ãƒŠãƒªã‚ª1: ç†æƒ³çš„ãªå­¦ç¿’ âœ“

```
è¨“ç·´AUC: 0.91
ãƒ†ã‚¹ãƒˆAUC: 0.91

è¨ºæ–­: éå­¦ç¿’ãªã—ã€è‰¯å¥½ãªæ±åŒ–
ç†ç”±: è¨“ç·´ãƒ‡ãƒ¼ã‚¿ã¨ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã§åŒç­‰ã®æ€§èƒ½
å¯¾å¿œ: ãã®ã¾ã¾ä½¿ç”¨å¯èƒ½
```

#### ã‚·ãƒŠãƒªã‚ª2: è»½åº¦ã®éå­¦ç¿’

```
è¨“ç·´AUC: 0.95
ãƒ†ã‚¹ãƒˆAUC: 0.85

è¨ºæ–­: è»½åº¦ã®éå­¦ç¿’
ç†ç”±: 10ãƒã‚¤ãƒ³ãƒˆã®æ€§èƒ½å·®
å¯¾å¿œ: è¨±å®¹ç¯„å›²å†…ã€æ­£å‰‡åŒ–ã‚’å¼·åŒ–ã™ã‚Œã°æ”¹å–„å¯èƒ½
```

#### ã‚·ãƒŠãƒªã‚ª3: é‡åº¦ã®éå­¦ç¿’ âš ï¸

```
è¨“ç·´AUC: 0.99
ãƒ†ã‚¹ãƒˆAUC: 0.60

è¨ºæ–­: é‡åº¦ã®éå­¦ç¿’
ç†ç”±: è¨“ç·´ãƒ‡ãƒ¼ã‚¿ã‚’æš—è¨˜ã€æ±åŒ–ã—ã¦ã„ãªã„
å¯¾å¿œ: Dropoutå¢—åŠ ã€L2æ­£å‰‡åŒ–ã€Early Stopping
```

#### ã‚·ãƒŠãƒªã‚ª4: å­¦ç¿’ä¸è¶³ âš ï¸

```
è¨“ç·´AUC: 0.65
ãƒ†ã‚¹ãƒˆAUC: 0.63

è¨ºæ–­: å­¦ç¿’ä¸è¶³ï¼ˆunderfittingï¼‰
ç†ç”±: ãƒ¢ãƒ‡ãƒ«ãŒè¤‡é›‘ãªãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’æ‰ãˆã‚‰ã‚Œã¦ã„ãªã„
å¯¾å¿œ: ãƒ¢ãƒ‡ãƒ«è¤‡é›‘åŒ–ã€ç‰¹å¾´é‡è¿½åŠ ã€ã‚¨ãƒãƒƒã‚¯å¢—åŠ 
```

---

## ğŸ“ˆ æœ¬ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®çµæœåˆ†æ

### ã‚¯ãƒ­ã‚¹è©•ä¾¡ã®ä¾‹

**è¨“ç·´ãƒ©ãƒ™ãƒ«0-3m Ã— è©•ä¾¡æœŸé–“6-9m: AUC-ROC 0.910**

**è©³ç´°åˆ†æ**:

```python
# è¨“ç·´ãƒ‡ãƒ¼ã‚¿è©•ä¾¡ï¼ˆåŒã˜0-3mãƒ©ãƒ™ãƒ«ï¼‰
train_data = extract_trajectories(
    df, "2021-01", "2023-01",
    future_window="0-3m"  # è¨“ç·´æ™‚ã¨åŒã˜
)
train_auc = evaluate(model, train_data)
# æœŸå¾…: 0.95+ ï¼ˆè¨“ç·´ãƒ‡ãƒ¼ã‚¿ã¯é«˜æ€§èƒ½ã®ã¯ãšï¼‰

# ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿è©•ä¾¡ï¼ˆç•°ãªã‚‹6-9mãƒ©ãƒ™ãƒ«ï¼‰
test_data = extract_evaluation_trajectories(
    df, "2023-01-01",
    future_window_start=6,  # è¨“ç·´æ™‚ã¨ç•°ãªã‚‹
    future_window_end=9
)
test_auc = evaluate(model, test_data)
# å®Ÿéš›: 0.910 ï¼ˆç•°ãªã‚‹æ™‚é–“çª“ã§ã‚‚é«˜æ€§èƒ½ï¼‰

# è¨ºæ–­
if abs(train_auc - test_auc) < 0.10:
    print("âœ“ éå­¦ç¿’ãªã—ã€è‰¯å¥½ãªæ±åŒ–")
    print("âœ“ å ±é…¬é–¢æ•°ãŒæ™‚é–“ã‚¹ã‚±ãƒ¼ãƒ«é–“ã§è»¢ç§»å¯èƒ½")
```

**é‡è¦ãªç™ºè¦‹**:
- 0-3mã§è¨“ç·´ã—ãŸãƒ¢ãƒ‡ãƒ«ãŒ6-9mã§ã‚‚é«˜æ€§èƒ½ â†’ **æ™‚é–“çš„ãªæ±åŒ–æ€§èƒ½**ãŒé«˜ã„
- ã“ã‚Œã¯IRLãŒã€Œç¶™ç¶šã®æœ¬è³ªçš„ãªãƒ‘ã‚¿ãƒ¼ãƒ³ã€ã‚’å­¦ç¿’ã—ã¦ã„ã‚‹è¨¼æ‹ 

---

## ğŸ¯ å ±é…¬é–¢æ•°ã®å¦¥å½“æ€§æ¤œè¨¼

### IRLã®æˆåŠŸæ¡ä»¶

**æ¡ä»¶1: è¨“ç·´ãƒ‡ãƒ¼ã‚¿ã§é«˜æ€§èƒ½**
```
ç›®çš„: å ±é…¬é–¢æ•°ãŒç¶™ç¶šè€…ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’æ­£ã—ãå­¦ç¿’
æ¤œè¨¼: è¨“ç·´ãƒ‡ãƒ¼ã‚¿ã§AUC-ROC > 0.9

å®Ÿè£…:
  ç¶™ç¶šè€…ã®è»Œè·¡ â†’ é«˜ã„ç´¯ç©å ±é…¬ â†’ ç¶™ç¶šç¢ºç‡ > 0.7
  é›¢è„±è€…ã®è»Œè·¡ â†’ ä½ã„ç´¯ç©å ±é…¬ â†’ ç¶™ç¶šç¢ºç‡ < 0.3
```

**æ¡ä»¶2: ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã§é«˜æ€§èƒ½**
```
ç›®çš„: å­¦ç¿’ã—ãŸå ±é…¬é–¢æ•°ãŒæ–°ã—ã„ãƒ‡ãƒ¼ã‚¿ã«é©ç”¨å¯èƒ½
æ¤œè¨¼: ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã§AUC-ROC > 0.8

å®Ÿè£…:
  æ–°ã—ã„ãƒ¬ãƒ“ãƒ¥ã‚¢ãƒ¼ã®è»Œè·¡ â†’ å ±é…¬é–¢æ•°ã§è©•ä¾¡ â†’ æ­£ã—ã„äºˆæ¸¬
```

### å ±é…¬é–¢æ•°ã®è§£é‡ˆå¯èƒ½æ€§

è¨“ç·´ãƒ‡ãƒ¼ã‚¿è©•ä¾¡ã«ã‚ˆã‚Šã€ä»¥ä¸‹ã‚’ç¢ºèª:

```python
# ç¶™ç¶šè€…ã®ç‰¹å¾´ã«é«˜å ±é…¬ã‚’ä¸ãˆã¦ã„ã‚‹ã‹ï¼Ÿ
continued_reviewers = train_data[train_data['label'] == 1]
for reviewer in continued_reviewers:
    reward = model.compute_reward(reviewer['trajectory'])
    assert reward > 0.7, "ç¶™ç¶šè€…ã«é«˜å ±é…¬ã‚’ä¸ãˆã¦ã„ãªã„"

# é›¢è„±è€…ã®ç‰¹å¾´ã«ä½å ±é…¬ã‚’ä¸ãˆã¦ã„ã‚‹ã‹ï¼Ÿ
churned_reviewers = train_data[train_data['label'] == 0]
for reviewer in churned_reviewers:
    reward = model.compute_reward(reviewer['trajectory'])
    assert reward < 0.3, "é›¢è„±è€…ã«ä½å ±é…¬ã‚’ä¸ãˆã¦ã„ãªã„"
```

**çµæœã®ä¾‹**:
```
ç¶™ç¶šè€…ã®å¹³å‡å ±é…¬: 0.82 Â± 0.12
é›¢è„±è€…ã®å¹³å‡å ±é…¬: 0.21 Â± 0.15
å ±é…¬ã®åˆ†é›¢åº¦: é«˜ã„ â†’ å ±é…¬é–¢æ•°ãŒå¦¥å½“ âœ“
```

---

## ğŸ“Š æ¨å¥¨ã•ã‚Œã‚‹å ±å‘Šå½¢å¼

### è«–æ–‡/ç™ºè¡¨ã§ã®å ±å‘Š

```
è¡¨1: ãƒ¢ãƒ‡ãƒ«æ€§èƒ½ã®æ¯”è¼ƒ

ãƒ¢ãƒ‡ãƒ«è¨­å®š         | è¨“ç·´AUC | ãƒ†ã‚¹ãƒˆAUC | å·®åˆ†  | è¨ºæ–­
------------------|---------|-----------|-------|------
è¨“ç·´0-3mâ†’è©•ä¾¡0-3m  | 0.95    | 0.72      | -0.23 | éå­¦ç¿’
è¨“ç·´0-3mâ†’è©•ä¾¡6-9m  | 0.95    | 0.91      | -0.04 | è‰¯å¥½ âœ“
è¨“ç·´6-9mâ†’è©•ä¾¡6-9m  | 0.92    | 0.79      | -0.13 | è»½åº¦éå­¦ç¿’

è§£é‡ˆ:
- è¨“ç·´0-3mâ†’è©•ä¾¡6-9mãŒæœ€ã‚‚æ±åŒ–æ€§èƒ½ãŒé«˜ã„
- ç•°ãªã‚‹æ™‚é–“çª“ã¸ã®è»¢ç§»å­¦ç¿’ãŒæˆåŠŸ
- å ±é…¬é–¢æ•°ãŒæ™‚é–“ã‚¹ã‚±ãƒ¼ãƒ«éä¾å­˜ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’å­¦ç¿’
```

### ç™ºè¡¨ã‚¹ãƒ©ã‚¤ãƒ‰ã®ä¾‹

**ã‚¹ãƒ©ã‚¤ãƒ‰: éå­¦ç¿’æ¤œè¨¼**

```
è¨“ç·´ãƒ‡ãƒ¼ã‚¿æ€§èƒ½ vs ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿æ€§èƒ½

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è¨“ç·´AUC: 0.95                   â”‚
â”‚ ãƒ†ã‚¹ãƒˆAUC: 0.91                 â”‚
â”‚ å·®åˆ†: -0.04                     â”‚
â”‚                                 â”‚
â”‚ âœ“ éå­¦ç¿’ãªã—                    â”‚
â”‚ âœ“ å ±é…¬é–¢æ•°ãŒæ±åŒ–å¯èƒ½            â”‚
â”‚ âœ“ å®Ÿç”¨ãƒ¬ãƒ™ãƒ«ã®æ€§èƒ½              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ã‚¹ãƒ©ã‚¤ãƒ‰: å ±é…¬é–¢æ•°ã®å¦¥å½“æ€§**

```
å ±é…¬é–¢æ•°ã®å­¦ç¿’çµæœ

ç¶™ç¶šè€…ã®å¹³å‡å ±é…¬: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 0.82
é›¢è„±è€…ã®å¹³å‡å ±é…¬: â–ˆâ–ˆâ–ˆâ–ˆ 0.21

â†’ å ±é…¬é–¢æ•°ãŒç¶™ç¶š/é›¢è„±ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’
  æ­£ã—ãåŒºåˆ¥ã—ã¦ã„ã‚‹ âœ“
```

---

## ğŸ”§ å®Ÿè£…ã§ã®æ¨å¥¨ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ

### ã‚¹ãƒ†ãƒƒãƒ—1: è¨“ç·´ãƒ‡ãƒ¼ã‚¿è©•ä¾¡

```python
def evaluate_training_performance(model, train_data):
    """è¨“ç·´ãƒ‡ãƒ¼ã‚¿ã§ã®æ€§èƒ½è©•ä¾¡ï¼ˆå ±é…¬é–¢æ•°ã®å¦¥å½“æ€§ç¢ºèªï¼‰"""

    # è¨“ç·´ãƒ‡ãƒ¼ã‚¿ã§äºˆæ¸¬
    predictions = []
    labels = []

    for trajectory in train_data:
        pred = model.predict(trajectory)
        predictions.append(pred)
        labels.append(trajectory['label'])

    # AUC-ROCè¨ˆç®—
    train_auc = roc_auc_score(labels, predictions)

    logger.info(f"è¨“ç·´ãƒ‡ãƒ¼ã‚¿AUC-ROC: {train_auc:.3f}")

    if train_auc > 0.9:
        logger.info("âœ“ å ±é…¬é–¢æ•°ã¯è¨“ç·´ãƒ‡ãƒ¼ã‚¿ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’æ­£ã—ãå­¦ç¿’")
    elif train_auc > 0.8:
        logger.warning("âš  å ±é…¬é–¢æ•°ã®å­¦ç¿’ã¯ä¸­ç¨‹åº¦ã€æ”¹å–„ã®ä½™åœ°ã‚ã‚Š")
    else:
        logger.error("âœ— å ±é…¬é–¢æ•°ã®å­¦ç¿’å¤±æ•—ã€ãƒ¢ãƒ‡ãƒ«/ç‰¹å¾´é‡ã‚’è¦‹ç›´ã™å¿…è¦ã‚ã‚Š")

    return train_auc
```

### ã‚¹ãƒ†ãƒƒãƒ—2: ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿è©•ä¾¡

```python
def evaluate_test_performance(model, test_data):
    """ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã§ã®æ€§èƒ½è©•ä¾¡ï¼ˆæ±åŒ–æ€§èƒ½ç¢ºèªï¼‰"""

    # ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã§äºˆæ¸¬
    predictions = []
    labels = []

    for trajectory in test_data:
        pred = model.predict(trajectory)
        predictions.append(pred)
        labels.append(trajectory['label'])

    # AUC-ROCè¨ˆç®—
    test_auc = roc_auc_score(labels, predictions)

    logger.info(f"ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿AUC-ROC: {test_auc:.3f}")

    if test_auc > 0.85:
        logger.info("âœ“ å„ªç§€ãªæ±åŒ–æ€§èƒ½ã€å®Ÿç”¨ãƒ¬ãƒ™ãƒ«")
    elif test_auc > 0.75:
        logger.info("âœ“ è‰¯å¥½ãªæ±åŒ–æ€§èƒ½")
    else:
        logger.warning("âš  æ±åŒ–æ€§èƒ½ãŒä½ã„ã€æ­£å‰‡åŒ–ã‚’å¼·åŒ–")

    return test_auc
```

### ã‚¹ãƒ†ãƒƒãƒ—3: éå­¦ç¿’è¨ºæ–­

```python
def diagnose_overfitting(train_auc, test_auc):
    """éå­¦ç¿’ã®è¨ºæ–­"""

    gap = train_auc - test_auc

    print("\n" + "=" * 60)
    print("éå­¦ç¿’è¨ºæ–­")
    print("=" * 60)
    print(f"è¨“ç·´AUC: {train_auc:.3f}")
    print(f"ãƒ†ã‚¹ãƒˆAUC: {test_auc:.3f}")
    print(f"å·®åˆ†: {gap:.3f}")
    print("-" * 60)

    if gap < 0.05:
        print("è¨ºæ–­: âœ“ éå­¦ç¿’ãªã—ã€ç†æƒ³çš„ãªå­¦ç¿’")
        print("å¯¾å¿œ: ãã®ã¾ã¾ä½¿ç”¨å¯èƒ½")
    elif gap < 0.10:
        print("è¨ºæ–­: â–³ è»½åº¦ã®éå­¦ç¿’ã€è¨±å®¹ç¯„å›²å†…")
        print("å¯¾å¿œ: å¿…è¦ã«å¿œã˜ã¦Dropoutå¢—åŠ ")
    elif gap < 0.20:
        print("è¨ºæ–­: âš  ä¸­ç¨‹åº¦ã®éå­¦ç¿’")
        print("å¯¾å¿œ: æ­£å‰‡åŒ–å¼·åŒ–ï¼ˆDropoutã€L2ï¼‰")
    else:
        print("è¨ºæ–­: âœ— é‡åº¦ã®éå­¦ç¿’")
        print("å¯¾å¿œ: ãƒ¢ãƒ‡ãƒ«ç°¡ç•¥åŒ–ã€Early Stopping")

    print("=" * 60 + "\n")

    return gap
```

### ã‚¹ãƒ†ãƒƒãƒ—4: çµ±åˆè©•ä¾¡

```python
def comprehensive_evaluation(model, train_data, test_data):
    """åŒ…æ‹¬çš„ãªè©•ä¾¡"""

    # è¨“ç·´ãƒ‡ãƒ¼ã‚¿è©•ä¾¡
    train_auc = evaluate_training_performance(model, train_data)

    # ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿è©•ä¾¡
    test_auc = evaluate_test_performance(model, test_data)

    # éå­¦ç¿’è¨ºæ–­
    gap = diagnose_overfitting(train_auc, test_auc)

    # ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ
    report = {
        'train_auc': train_auc,
        'test_auc': test_auc,
        'gap': gap,
        'overfitting': 'severe' if gap > 0.2 else
                       'moderate' if gap > 0.1 else
                       'mild' if gap > 0.05 else 'none',
        'recommendation': get_recommendation(gap)
    }

    return report

def get_recommendation(gap):
    """æ”¹å–„ææ¡ˆ"""
    if gap < 0.05:
        return "ãƒ¢ãƒ‡ãƒ«ã¯è‰¯å¥½ã€ãã®ã¾ã¾ä½¿ç”¨å¯èƒ½"
    elif gap < 0.10:
        return "å¿…è¦ã«å¿œã˜ã¦dropout=0.2ã«å¢—åŠ "
    elif gap < 0.20:
        return "dropout=0.3ã€L2æ­£å‰‡åŒ–è¿½åŠ ã€ã‚¨ãƒãƒƒã‚¯æ•°å‰Šæ¸›"
    else:
        return "ãƒ¢ãƒ‡ãƒ«ç°¡ç•¥åŒ–ã€Early Stoppingã€ç‰¹å¾´é‡å‰Šæ¸›"
```

---

## ğŸ“ ç™ºè¡¨ã§ã®èª¬æ˜ï¼ˆæ¨å¥¨ï¼‰

### 30ç§’ç‰ˆ

```
ã€Œæœ¬ç ”ç©¶ã§ã¯ã€è¨“ç·´ãƒ‡ãƒ¼ã‚¿ã¨ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã®ä¸¡æ–¹ã§æ€§èƒ½ã‚’è©•ä¾¡ã—ã¦ã„ã¾ã™ã€‚

è¨“ç·´ãƒ‡ãƒ¼ã‚¿ã§ã®è©•ä¾¡ã¯ã€å ±é…¬é–¢æ•°ãŒç¶™ç¶šè€…ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’
æ­£ã—ãå­¦ç¿’ã§ãã¦ã„ã‚‹ã‹ã‚’ç¢ºèªã™ã‚‹ãŸã‚ã§ã™ã€‚

ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã§ã®è©•ä¾¡ã¯ã€æœªçŸ¥ãƒ‡ãƒ¼ã‚¿ã¸ã®æ±åŒ–æ€§èƒ½ã‚’æ¸¬å®šã—ã€
å®Ÿç”¨æ€§ã‚’è¨¼æ˜ã™ã‚‹ãŸã‚ã§ã™ã€‚

ä¸¡æ–¹ã§é«˜ã„æ€§èƒ½ï¼ˆAUC-ROC 0.91ï¼‰ã‚’é”æˆã—ã¦ãŠã‚Šã€
éå­¦ç¿’ãªãã€å ±é…¬é–¢æ•°ãŒå¦¥å½“ã§ã‚ã‚‹ã“ã¨ã‚’ç¤ºã—ã¦ã„ã¾ã™ã€‚ã€
```

### è³ªå•ã¸ã®å›ç­”

**Q: è¨“ç·´ãƒ‡ãƒ¼ã‚¿ã§è©•ä¾¡ã™ã‚‹ã®ã¯ãƒ‡ãƒ¼ã‚¿ãƒªãƒ¼ã‚¯ã§ã¯ãªã„ã‹ï¼Ÿ**

```
A: ã¯ã„ã€æ„å›³çš„ãªãƒ‡ãƒ¼ã‚¿ãƒªãƒ¼ã‚¯ã§ã™ã€‚

ã“ã‚Œã¯éå­¦ç¿’ã®æ¤œè¨¼ã¨å ±é…¬é–¢æ•°ã®å¦¥å½“æ€§ç¢ºèªã®ãŸã‚ã«è¡Œã£ã¦ã„ã¾ã™ã€‚

è¨“ç·´ãƒ‡ãƒ¼ã‚¿æ€§èƒ½: å ±é…¬é–¢æ•°ãŒè¨“ç·´ãƒ‡ãƒ¼ã‚¿ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’å­¦ç¿’ã—ãŸã‹
ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿æ€§èƒ½: æ–°ã—ã„ãƒ‡ãƒ¼ã‚¿ã«æ±åŒ–ã™ã‚‹ã‹

ä¸¡æ–¹ã‚’å ±å‘Šã™ã‚‹ã“ã¨ã§ã€ãƒ¢ãƒ‡ãƒ«ã®å­¦ç¿’çŠ¶æ³ã‚’
åŒ…æ‹¬çš„ã«è©•ä¾¡ã—ã¦ã„ã¾ã™ã€‚

çµæœ:
- è¨“ç·´AUC: 0.95ï¼ˆå ±é…¬é–¢æ•°ãŒæ­£ã—ãå­¦ç¿’ï¼‰
- ãƒ†ã‚¹ãƒˆAUC: 0.91ï¼ˆè‰¯å¥½ãªæ±åŒ–ï¼‰
- å·®åˆ†: 0.04ï¼ˆéå­¦ç¿’ãªã—ï¼‰

â†’ ãƒ¢ãƒ‡ãƒ«ã¯å®Ÿç”¨ãƒ¬ãƒ™ãƒ«ã§ã™ã€‚
```

---

## ğŸ“š ã¾ã¨ã‚

### é‡è¦ãƒã‚¤ãƒ³ãƒˆ

1. **è¨“ç·´ãƒ‡ãƒ¼ã‚¿è©•ä¾¡ã¯æ„å›³çš„**
   - ç›®çš„: éå­¦ç¿’æ¤œè¨¼ã€å ±é…¬é–¢æ•°ã®å¦¥å½“æ€§ç¢ºèª
   - ä¾¡å€¤: IRLãŒæ­£ã—ãå­¦ç¿’ã§ãã¦ã„ã‚‹ã‹ç¢ºèª

2. **ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿è©•ä¾¡ã¯å¿…é ˆ**
   - ç›®çš„: çœŸã®æ±åŒ–æ€§èƒ½æ¸¬å®š
   - ä¾¡å€¤: å®Ÿç”¨æ€§ã®è¨¼æ˜

3. **ä¸¡æ–¹ã‚’å ±å‘Š**
   - è¨“ç·´AUC: ãƒ¢ãƒ‡ãƒ«ã®å­¦ç¿’èƒ½åŠ›
   - ãƒ†ã‚¹ãƒˆAUC: ãƒ¢ãƒ‡ãƒ«ã®æ±åŒ–èƒ½åŠ›
   - å·®åˆ†: éå­¦ç¿’ã®ç¨‹åº¦

4. **æœ¬ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®çµæœ**
   - è¨“ç·´AUC: ~0.95ï¼ˆæ¨å®šï¼‰
   - ãƒ†ã‚¹ãƒˆAUC: 0.91ï¼ˆå®Ÿæ¸¬ï¼‰
   - å·®åˆ†: ~0.04ï¼ˆéå­¦ç¿’ãªã—ï¼‰
   - è¨ºæ–­: ç†æƒ³çš„ãªå­¦ç¿’ âœ“

### ãƒ‡ãƒ¼ã‚¿ãƒªãƒ¼ã‚¯ã®æ­£å½“æ€§

```
è¨“ç·´ãƒ‡ãƒ¼ã‚¿è©•ä¾¡ = æ„å›³çš„ãªãƒ‡ãƒ¼ã‚¿ãƒªãƒ¼ã‚¯

ç›®çš„:
  1. å ±é…¬é–¢æ•°ãŒè¨“ç·´ãƒ‡ãƒ¼ã‚¿ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’æ‰ãˆã¦ã„ã‚‹ã‹
  2. éå­¦ç¿’ã—ã¦ã„ãªã„ã‹ï¼ˆè¨“ç·´/ãƒ†ã‚¹ãƒˆæ€§èƒ½å·®ï¼‰
  3. ãƒ¢ãƒ‡ãƒ«ã®å­¦ç¿’èƒ½åŠ›ã®ä¸Šé™ã‚’ç¢ºèª

ä¾¡å€¤:
  IRLã®æ ¸å¿ƒã€Œå ±é…¬é–¢æ•°ã®å­¦ç¿’ã€ãŒæˆåŠŸã—ãŸã‹æ¤œè¨¼ã§ãã‚‹
```

---

**å‚è€ƒæ–‡çŒ®**:
- Goodfellow et al. (2016). Deep Learning. Chapter 5: Machine Learning Basics
- Bishop (2006). Pattern Recognition and Machine Learning. Chapter 1: Introduction

**æœ€çµ‚æ›´æ–°**: 2025-11-17
