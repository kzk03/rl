# 実験結果: 依頼なしの影響

## 実験の目的

依頼なしのサンプルを負例として含めるべきか、除外すべきかを検証する。

---

## 実験設定

### 3つのアプローチ

1. **依頼なし除外版**: ラベル期間に依頼がない場合は除外
2. **依頼なし含む（重み0.3版）**: 依頼なしも負例として扱う（weight=0.3）
3. **依頼なし含む（重み0.1版）**: 依頼なしも負例として扱う（weight=0.1）

### 共通設定

- Random Seed: 777
- Learning Rate: 0.00005
- Epochs: 20
- Dropout: 0.3

---

## 結果の比較

### 対角線評価（同一期間）

| アプローチ            | 平均AUC-PR | 正例率 | 備考               |
| --------------------- | ---------- | ------ | ------------------ |
| 依頼なし除外          | N/A        | N/A    | 実施せず           |
| 依頼なし含む（重み0.3） | **0.716**  | 34.7%  | 以前の最良         |
| 依頼なし含む（重み0.1） | **0.460**  | 14.0%  | 今回               |

### 詳細な精度（重み0.3版）

| 期間        | AUC-PR | Precision | Recall | F1-score | サンプル数 | 正例率 |
| ----------- | ------ | --------- | ------ | -------- | ---------- | ------ |
| train_0-3m  | 0.653  | 0.593     | 0.762  | 0.667    | 60         | 35.0%  |
| train_3-6m  | 0.811  | 0.714     | 0.833  | 0.769    | 55         | 32.7%  |
| train_6-9m  | 0.749  | 0.800     | 0.615  | 0.696    | 42         | 31.0%  |
| train_9-12m | 0.651  | 0.556     | 0.938  | 0.698    | 39         | 41.0%  |

### 詳細な精度（重み0.1版）

| 期間        | AUC-PR | Precision | Recall | F1-score | サンプル数 | 正例率 |
| ----------- | ------ | --------- | ------ | -------- | ---------- | ------ |
| train_0-3m  | 0.403  | 0.360     | 0.429  | 0.391    | 121        | 17.4%  |
| train_3-6m  | 0.404  | 0.438     | 0.389  | 0.412    | 121        | 14.9%  |
| train_6-9m  | 0.489  | 0.600     | 0.462  | 0.522    | 121        | 10.7%  |
| train_9-12m | 0.544  | 0.700     | 0.438  | 0.538    | 121        | 13.2%  |

---

## 主な発見

### 1. 精度の大幅な低下

- **依頼なしを含めると**: AUC-PR 0.716 → 0.460（**-35.8%**）
- **サンプル重みを下げても改善しない**: 0.3 → 0.1 でも改善なし

### 2. クラス不均衡の悪化

- **依頼なしを含めると**: 正例率 34.7% → 14.0%（**-20.7pt**）
- **極端な不均衡**: 10.7%~17.4% という非常に低い正例率

### 3. サンプル数の増加

- **依頼なしを含めると**: 39~60サンプル → 121サンプル
- **しかし精度は低下**: サンプル数が増えても精度が上がらない

---

## 結論

### 依頼なしは除外すべき

1. **ノイズの削減**: 依頼なしは離脱のシグナルとは限らない
2. **精度の向上**: 除外することで AUC-PR が 0.716 に向上
3. **バランスの改善**: 正例率 34.7% という現実的な割合
4. **サンプル重みの調整**: 0.3 → 0.1 では改善しない

### 推奨されるアプローチ

**重み0.3版（依頼なし含む）**
- 平均 AUC-PR: 0.716
- 正例率: 34.7%
- サンプル重み: 依頼あり=1.0, 依頼なし=0.3

ただし、依頼なしを完全に除外するアプローチ（未実施）も検討の余地がある。

---

## 今後の検討事項

1. **依頼なし除外版の実験**: 依頼なしを完全に除外した場合の精度
2. **サンプル重みの最適化**: 0.3以外の値の探索
3. **データ拡充**: 他のプロジェクトからのデータ追加
4. **特徴量の改善**: より効果的な特徴量の追加

