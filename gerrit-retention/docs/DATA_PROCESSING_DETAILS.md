# ãƒ‡ãƒ¼ã‚¿å‡¦ç†ã®è©³ç´°ï¼šã‚¹ãƒ†ãƒƒãƒ—å˜ä½ã¨ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼æ¡ä»¶

**æœ€çµ‚æ›´æ–°**: 2025-10-17
**ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ**: Gerrit Retention IRL
**ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹**: OpenStack Gerrit (review_requests_openstack_multi_5y_detail.csv)

---

## ğŸ“Š ãƒ‡ãƒ¼ã‚¿ã®å…¨ä½“åƒ

### ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®åŸºæœ¬æƒ…å ±

```
ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«: data/review_requests_openstack_multi_5y_detail.csv
ç·ãƒ¬ã‚³ãƒ¼ãƒ‰æ•°: 137,632ä»¶
æœŸé–“: 2012-06-20 ~ 2025-09-27 (ç´„13å¹´é–“)
ãƒ¦ãƒ‹ãƒ¼ã‚¯ãƒ¬ãƒ“ãƒ¥ã‚¢ãƒ¼æ•°: 1,379äºº
ãƒ¦ãƒ‹ãƒ¼ã‚¯ã‚ªãƒ¼ãƒŠãƒ¼æ•°: 1,034äºº
ã‚«ãƒ©ãƒ æ•°: 65
```

### ãƒ‡ãƒ¼ã‚¿ã®æ§‹é€ 

```
å„ãƒ¬ã‚³ãƒ¼ãƒ‰ = 1ã¤ã®ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒªã‚¯ã‚¨ã‚¹ãƒˆï¼ˆreview requestï¼‰

ä¸»è¦ã‚«ãƒ©ãƒ :
- change_id: å¤‰æ›´ID
- project: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåï¼ˆä¾‹: openstack/novaï¼‰
- owner_email: å¤‰æ›´ã®ä½œæˆè€…
- reviewer_email: ãƒ¬ãƒ“ãƒ¥ã‚¢ãƒ¼ï¼ˆè©•ä¾¡å¯¾è±¡ï¼‰
- request_time: ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®æ—¥æ™‚
- responded_within_days: å¿œç­”ã¾ã§ã®æ—¥æ•°
- label: ãƒ¬ãƒ“ãƒ¥ãƒ¼çµæœï¼ˆæ‰¿èª/å´ä¸‹/ãã®ä»–ï¼‰
```

---

## ğŸ¯ ã‚¹ãƒ†ãƒƒãƒ—ï¼ˆStepï¼‰ã®å®šç¾©

### ã€Œã‚¹ãƒ†ãƒƒãƒ—ã€ã¨ã¯ä½•ã‹ï¼Ÿ

**ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ã¯ã€Œã‚¹ãƒ†ãƒƒãƒ—ã€ã¨ã„ã†æ¦‚å¿µã¯ç›´æ¥çš„ã«ã¯å­˜åœ¨ã—ã¾ã›ã‚“ã€‚**

ä»£ã‚ã‚Šã«ã€ä»¥ä¸‹ã®**æ™‚ç³»åˆ—å˜ä½**ã§ãƒ‡ãƒ¼ã‚¿ã‚’å‡¦ç†ã—ã¾ã™ï¼š

### 1. ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒªã‚¯ã‚¨ã‚¹ãƒˆï¼ˆReview Requestï¼‰

**æœ€å°å˜ä½**: 1ä»¶ã®ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒªã‚¯ã‚¨ã‚¹ãƒˆ

```
ãƒ¬ã‚³ãƒ¼ãƒ‰ä¾‹:
{
  'change_id': 'openstack%2Fnova~960130',
  'reviewer_email': 'herveberaud.pro@gmail.com',
  'request_time': '2025-09-09T11:48:13',
  'project': 'openstack/nova',
  'label': 0
}
```

**æ„å‘³**:
- ã‚ã‚‹ã‚ªãƒ¼ãƒŠãƒ¼ãŒå¤‰æ›´ã‚’æå‡º
- ãã®å¤‰æ›´ã«å¯¾ã—ã¦ãƒ¬ãƒ“ãƒ¥ã‚¢ãƒ¼ãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚ŒãŸ
- ã“ã®ã‚¤ãƒ™ãƒ³ãƒˆãŒ1ã¤ã®ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒªã‚¯ã‚¨ã‚¹ãƒˆ

### 2. è»Œè·¡ï¼ˆTrajectoryï¼‰

**é›†ç´„å˜ä½**: ç‰¹å®šã®é–‹ç™ºè€…ã®ä¸€å®šæœŸé–“ã®æ´»å‹•è¨˜éŒ²

```python
trajectory = {
    'developer': {
        'developer_id': 'alice@example.com',
        'experience_days': 730,
        'total_changes': 120,
        # ... çŠ¶æ…‹ç‰¹å¾´é‡32æ¬¡å…ƒ
    },
    'activity_history': [
        # æœ€è¿‘15å€‹ã®ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
        {'type': 'review', 'timestamp': '2022-12-20', ...},
        {'type': 'review', 'timestamp': '2022-12-15', ...},
        # ...
    ],
    'continued': True,  # ç¶™ç¶šãƒ©ãƒ™ãƒ«
    'context_date': datetime(2023, 1, 1)
}
```

**æ§‹æˆè¦ç´ **:
- **å­¦ç¿’æœŸé–“ï¼ˆHistory Periodï¼‰**: éå»N ãƒ¶æœˆã®æ´»å‹•ï¼ˆä¾‹: 12ãƒ¶æœˆï¼‰
- **äºˆæ¸¬æœŸé–“ï¼ˆTarget Periodï¼‰**: æœªæ¥Mãƒ¶æœˆã®æ´»å‹•æœ‰ç„¡ï¼ˆä¾‹: 6ãƒ¶æœˆï¼‰
- **ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆæ—¥ï¼ˆSnapshot Dateï¼‰**: å­¦ç¿’ã¨äºˆæ¸¬ã®å¢ƒç•Œï¼ˆä¾‹: 2023-01-01ï¼‰

### 3. ã‚¨ãƒãƒƒã‚¯ï¼ˆEpochï¼‰

**è¨“ç·´å˜ä½**: ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®è¨“ç·´ãƒ«ãƒ¼ãƒ—

```
Epoch 0:  å…¨è»Œè·¡ã‚’1å›å­¦ç¿’  â†’ å¹³å‡æå¤± = 0.527
Epoch 1:  å…¨è»Œè·¡ã‚’1å›å­¦ç¿’  â†’ å¹³å‡æå¤± = 0.510
...
Epoch 30: å…¨è»Œè·¡ã‚’1å›å­¦ç¿’  â†’ å¹³å‡æå¤± = 0.336  (åæŸ)
```

**ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤**: 30ã‚¨ãƒãƒƒã‚¯

---

## ğŸ” ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°æ¡ä»¶

### ç¾åœ¨ã®å®Ÿè£…çŠ¶æ³

**é‡è¦**: ç¾åœ¨ã®IRLè¨“ç·´ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ã¯ã€**æ˜ç¤ºçš„ãªãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã¯è¡Œã‚ã‚Œã¦ã„ã¾ã›ã‚“ã€‚**

```python
# train_temporal_irl_sliding_window_fixed_pop.py
def extract_target_reviewers(df, snapshot_date, reference_period_months):
    """åŸºæº–æœŸé–“ã§å¯¾è±¡ãƒ¬ãƒ“ãƒ¥ã‚¢ãƒ¼ã‚’æ±ºå®š"""
    reference_start = snapshot_date - pd.DateOffset(months=reference_period_months)
    reference_df = df[(df['request_time'] >= reference_start) &
                      (df['request_time'] < snapshot_date)]

    # ã™ã¹ã¦ã®ãƒ¦ãƒ‹ãƒ¼ã‚¯ãƒ¬ãƒ“ãƒ¥ã‚¢ãƒ¼ã‚’å¯¾è±¡ã¨ã™ã‚‹
    target_reviewers = set(reference_df['reviewer_email'].unique())

    return target_reviewers  # ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ãªã—
```

### ãƒœãƒƒãƒˆã‚¢ã‚«ã‚¦ãƒ³ãƒˆæ¤œå‡ºï¼ˆå®Ÿè£…æ¸ˆã¿ã ãŒæœªä½¿ç”¨ï¼‰

`data_processing/preprocessing/data_cleaning.py` ã«ãƒœãƒƒãƒˆæ¤œå‡ºæ©Ÿèƒ½ãŒå®Ÿè£…ã•ã‚Œã¦ã„ã¾ã™ãŒã€**IRLè¨“ç·´ã§ã¯ä½¿ç”¨ã•ã‚Œã¦ã„ã¾ã›ã‚“**ã€‚

```python
class DataCleaner:
    def __init__(self):
        self.bot_patterns = [
            "bot", "automation", "jenkins", "ci", "build", "deploy"
        ]

    def detect_bot_accounts(self, df, email_column='email'):
        """ãƒœãƒƒãƒˆã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’æ¤œå‡º"""
        bot_mask = pd.Series([False] * len(df), index=df.index)

        # 1. ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒãƒ³ã‚°
        for pattern in self.bot_patterns:
            pattern_mask = df[email_column].str.contains(
                pattern, case=False, na=False, regex=False
            )
            bot_mask |= pattern_mask

        # 2. ç•°å¸¸ãªé«˜æ´»å‹•é‡ï¼ˆçµ±è¨ˆçš„å¤–ã‚Œå€¤ï¼‰
        if 'changes_authored' in df.columns:
            changes_mean = df['changes_authored'].mean()
            changes_std = df['changes_authored'].std()
            high_activity_threshold = changes_mean + (3 * changes_std)

            high_activity_mask = df['changes_authored'] > high_activity_threshold
            bot_mask |= high_activity_mask

        # 3. åå‰ãŒãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã¨åŒã˜ï¼ˆè‡ªå‹•ç”Ÿæˆã‚¢ã‚«ã‚¦ãƒ³ãƒˆï¼‰
        if 'name' in df.columns:
            auto_name_mask = df['name'] == df[email_column]
            bot_mask |= auto_name_mask

        return bot_mask
```

### OpenStackãƒ‡ãƒ¼ã‚¿ã«å«ã¾ã‚Œã‚‹å¯èƒ½æ€§ã®ã‚ã‚‹ãƒœãƒƒãƒˆ

```
ã‚µãƒ³ãƒ—ãƒ«ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‹ã‚‰æ¨æ¸¬:
- DL-ARC-InfoScale-OpenStack-CI@arctera.io     â† CIé–¢é€£ï¼ˆå¯èƒ½æ€§é«˜ï¼‰
- openstack@lightbitslabs.com                   â† çµ„ç¹”ãƒ¡ãƒ¼ãƒ«ï¼ˆbotå¯èƒ½æ€§ï¼‰
- openstack-ci@sap.com                          â† CIé–¢é€£ï¼ˆå¯èƒ½æ€§é«˜ï¼‰
```

---

## ğŸ“ˆ è»Œè·¡æŠ½å‡ºã®è©³ç´°ãƒ—ãƒ­ã‚»ã‚¹

### ã‚¹ãƒ†ãƒƒãƒ—1: å¯¾è±¡ãƒ¬ãƒ“ãƒ¥ã‚¢ãƒ¼ã®æ±ºå®š

```python
# åŸºæº–æœŸé–“ã§æ´»å‹•ãŒã‚ã£ãŸãƒ¬ãƒ“ãƒ¥ã‚¢ãƒ¼ã‚’æŠ½å‡º
snapshot_date = datetime(2023, 1, 1)
reference_period = 6  # ãƒ¶æœˆ

# 2022-07-01 ~ 2023-01-01 ã®æœŸé–“ã§æ´»å‹•ãŒã‚ã£ãŸãƒ¬ãƒ“ãƒ¥ã‚¢ãƒ¼
reference_start = datetime(2022, 7, 1)
reference_df = df[(df['request_time'] >= reference_start) &
                  (df['request_time'] < snapshot_date)]

target_reviewers = set(reference_df['reviewer_email'].unique())
# çµæœ: 291äººï¼ˆOpenStack 2023-01-01 åŸºæº–ï¼‰
```

**ç›®çš„**:
- ã™ã¹ã¦ã®å­¦ç¿’æœŸé–“ã§åŒã˜ãƒ¬ãƒ“ãƒ¥ã‚¢ãƒ¼ã‚’å¯¾è±¡ã¨ã™ã‚‹
- å…¬å¹³ãªæ¯”è¼ƒã®ãŸã‚

### ã‚¹ãƒ†ãƒƒãƒ—2: è»Œè·¡ã®æŠ½å‡º

```python
def extract_trajectories_with_fixed_population(
    df, snapshot_date, history_months, target_months, target_reviewers
):
    """å›ºå®šå¯¾è±¡è€…ã§ã®è»Œè·¡æŠ½å‡º"""

    # å­¦ç¿’æœŸé–“ã®ãƒ‡ãƒ¼ã‚¿
    history_start = snapshot_date - pd.DateOffset(months=history_months)
    history_df = df[(df['request_time'] >= history_start) &
                    (df['request_time'] < snapshot_date)]

    # äºˆæ¸¬æœŸé–“ã®ãƒ‡ãƒ¼ã‚¿
    target_end = snapshot_date + pd.DateOffset(months=target_months)
    target_df = df[(df['request_time'] >= snapshot_date) &
                   (df['request_time'] < target_end)]

    trajectories = []
    skipped_no_history = 0

    for reviewer in target_reviewers:
        reviewer_history = history_df[history_df['reviewer_email'] == reviewer]
        reviewer_target = target_df[target_df['reviewer_email'] == reviewer]

        # ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼æ¡ä»¶1: å­¦ç¿’æœŸé–“ã«æ´»å‹•ãªã— â†’ ã‚¹ã‚­ãƒƒãƒ—
        if len(reviewer_history) == 0:
            skipped_no_history += 1
            continue

        # ç¶™ç¶šãƒ©ãƒ™ãƒ«: äºˆæ¸¬æœŸé–“ä¸­ã«æ´»å‹•ãŒã‚ã£ãŸã‹
        continued = len(reviewer_target) > 0

        # æ´»å‹•å±¥æ­´ã‚’æ§‹ç¯‰
        activity_history = []
        for _, row in reviewer_history.iterrows():
            activity_history.append({
                'type': 'review',
                'timestamp': row['request_time'],
                'project': row.get('project', 'unknown'),
                # ...
            })

        trajectories.append({
            'developer': {...},
            'activity_history': activity_history,
            'continued': continued,
            'context_date': snapshot_date
        })

    return trajectories
```

### ã‚¹ãƒ†ãƒƒãƒ—3: è¨“ç·´/ãƒ†ã‚¹ãƒˆåˆ†å‰²

```python
# 80/20 åˆ†å‰²ï¼ˆãƒ©ãƒ³ãƒ€ãƒ ã‚·ãƒ£ãƒƒãƒ•ãƒ«ï¼‰
np.random.seed(42)
np.random.shuffle(trajectories)
split_idx = int(len(trajectories) * 0.8)

train_trajectories = trajectories[:split_idx]
test_trajectories = trajectories[split_idx:]

# ä¾‹: 291äºº â†’ 232äººï¼ˆè¨“ç·´ï¼‰+ 59äººï¼ˆãƒ†ã‚¹ãƒˆï¼‰
```

---

## ğŸ›ï¸ ç¾åœ¨ã®ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼æ¡ä»¶ã¾ã¨ã‚

### âœ… å®Ÿæ–½ã•ã‚Œã¦ã„ã‚‹ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼

| # | ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼æ¡ä»¶ | ã‚¿ã‚¤ãƒŸãƒ³ã‚° | é™¤å¤–æ•° | ç†ç”± |
|---|--------------|-----------|-------|------|
| 1 | **åŸºæº–æœŸé–“ã«æ´»å‹•ãªã—** | å¯¾è±¡ãƒ¬ãƒ“ãƒ¥ã‚¢ãƒ¼æ±ºå®šæ™‚ | ä¸æ˜ | å›ºå®šæ¯é›†å›£ã®å®šç¾© |
| 2 | **å­¦ç¿’æœŸé–“ã«æ´»å‹•ãªã—** | è»Œè·¡æŠ½å‡ºæ™‚ | ä¾‹: 101äºº/291äºº | å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ãªã— |

### âŒ å®Ÿæ–½ã•ã‚Œã¦ã„ãªã„ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼

| # | ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼å€™è£œ | ç¾çŠ¶ | å½±éŸ¿ |
|---|--------------|------|------|
| 1 | **ãƒœãƒƒãƒˆã‚¢ã‚«ã‚¦ãƒ³ãƒˆé™¤å¤–** | æœªå®Ÿæ–½ | CI botãªã©ãŒå«ã¾ã‚Œã‚‹å¯èƒ½æ€§ |
| 2 | **æœ€å°æ´»å‹•å›æ•°** | æœªå®Ÿæ–½ | 1å›ã®ã¿ã®æ´»å‹•è€…ã‚‚å«ã‚€ |
| 3 | **ç•°å¸¸ãªé«˜æ´»å‹•é‡** | æœªå®Ÿæ–½ | å¤–ã‚Œå€¤ãŒå«ã¾ã‚Œã‚‹å¯èƒ½æ€§ |
| 4 | **ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆé™å®š** | æœªå®Ÿæ–½ | å…¨ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå¯¾è±¡ |

---

## ğŸ“Š å®Ÿéš›ã®ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼åŠ¹æœï¼ˆä¾‹: 12m Ã— 6m, 2023-01-01ï¼‰

```
ã€ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³IRLå®Ÿé¨“çµæœã€‘
1. åŸºæº–æœŸé–“ï¼ˆ6ãƒ¶æœˆï¼‰ã§å¯¾è±¡ãƒ¬ãƒ“ãƒ¥ã‚¢ãƒ¼æ±ºå®š
   â†’ 291äºº

2. å­¦ç¿’æœŸé–“ï¼ˆ12ãƒ¶æœˆï¼‰ã§è»Œè·¡æŠ½å‡º
   - å¯¾è±¡ãƒ¬ãƒ“ãƒ¥ã‚¢ãƒ¼ç·æ•°: 291äºº
   - å­¦ç¿’æœŸé–“ã«æ´»å‹•ãªã—ã§ã‚¹ã‚­ãƒƒãƒ—: 0äºº
   - ä½œæˆã•ã‚ŒãŸè»Œè·¡æ•°: 291ä»¶

3. è¨“ç·´/ãƒ†ã‚¹ãƒˆåˆ†å‰²
   - è¨“ç·´: 232ä»¶
   - ãƒ†ã‚¹ãƒˆ: 59ä»¶

4. ç¶™ç¶šç‡
   - è¨“ç·´: 65.9%
   - ãƒ†ã‚¹ãƒˆ: 44.8%
```

---

## ğŸ”§ æ¨å¥¨ã•ã‚Œã‚‹ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼æ”¹å–„

### å„ªå…ˆåº¦â˜…â˜…â˜…ï¼ˆå®Ÿè£…æ¨å¥¨ï¼‰

#### 1. ãƒœãƒƒãƒˆã‚¢ã‚«ã‚¦ãƒ³ãƒˆé™¤å¤–

```python
def filter_bot_accounts(df, reviewer_col='reviewer_email'):
    """ãƒœãƒƒãƒˆã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’é™¤å¤–"""
    bot_patterns = ['bot', 'ci', 'automation', 'jenkins', 'build']

    bot_mask = pd.Series([False] * len(df), index=df.index)
    for pattern in bot_patterns:
        bot_mask |= df[reviewer_col].str.contains(pattern, case=False, na=False)

    logger.info(f"ãƒœãƒƒãƒˆã‚¢ã‚«ã‚¦ãƒ³ãƒˆé™¤å¤–: {bot_mask.sum()}ä»¶")
    return df[~bot_mask]

# ä½¿ç”¨ä¾‹
df_filtered = filter_bot_accounts(df)
target_reviewers = extract_target_reviewers(df_filtered, ...)
```

**ç†ç”±**:
- CI bot ã¯äººé–“ã®è¡Œå‹•ãƒ‘ã‚¿ãƒ¼ãƒ³ã¨ç•°ãªã‚‹
- äºˆæ¸¬ç²¾åº¦ã«æ‚ªå½±éŸ¿ã‚’ä¸ãˆã‚‹å¯èƒ½æ€§
- OpenStackãƒ‡ãƒ¼ã‚¿ã« CIé–¢é€£ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ãŒå«ã¾ã‚Œã¦ã„ã‚‹

#### 2. æœ€å°æ´»å‹•å›æ•°ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼

```python
def filter_min_activity(df, target_reviewers, min_count=5):
    """æœ€å°æ´»å‹•å›æ•°ã§ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼"""
    activity_counts = df['reviewer_email'].value_counts()

    active_reviewers = set(
        activity_counts[activity_counts >= min_count].index
    )

    filtered_reviewers = target_reviewers & active_reviewers

    logger.info(f"æœ€å°æ´»å‹•å›æ•°ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ï¼ˆ{min_count}ä»¶ä»¥ä¸Šï¼‰:")
    logger.info(f"  é™¤å¤–å‰: {len(target_reviewers)}äºº")
    logger.info(f"  é™¤å¤–å¾Œ: {len(filtered_reviewers)}äºº")

    return filtered_reviewers
```

**ç†ç”±**:
- 1-2å›ã®ã¿ã®æ´»å‹•è€…ã¯çµ±è¨ˆçš„ã«ä¿¡é ¼æ€§ãŒä½ã„
- ç¶™ç¶šäºˆæ¸¬ãŒå›°é›£

### å„ªå…ˆåº¦â˜…â˜…ï¼ˆæ¤œè¨æ¨å¥¨ï¼‰

#### 3. ç•°å¸¸å€¤é™¤å¤–ï¼ˆå¤–ã‚Œå€¤ï¼‰

```python
def filter_outliers(df, reviewer_col='reviewer_email', std_threshold=3):
    """ç•°å¸¸ãªé«˜æ´»å‹•é‡ã‚’é™¤å¤–"""
    activity_counts = df[reviewer_col].value_counts()

    mean = activity_counts.mean()
    std = activity_counts.std()
    threshold = mean + (std_threshold * std)

    outliers = set(activity_counts[activity_counts > threshold].index)

    logger.info(f"å¤–ã‚Œå€¤é™¤å¤–ï¼ˆ{threshold:.0f}ä»¶ä»¥ä¸Šï¼‰: {len(outliers)}äºº")

    return df[~df[reviewer_col].isin(outliers)]
```

**ç†ç”±**:
- æ¥µç«¯ã«å¤šã„æ´»å‹•è€…ï¼ˆbotå¯èƒ½æ€§ã€å°‚ä»»ãƒ¬ãƒ“ãƒ¥ã‚¢ãƒ¼ï¼‰ã¯ä¸€èˆ¬çš„ã§ãªã„
- ãƒ¢ãƒ‡ãƒ«ãŒéå­¦ç¿’ã™ã‚‹å¯èƒ½æ€§

### å„ªå…ˆåº¦â˜…ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰

#### 4. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆé™å®š

```python
def filter_by_project(df, projects=['openstack/nova', 'openstack/neutron']):
    """ç‰¹å®šãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«é™å®š"""
    return df[df['project'].isin(projects)]
```

**ç†ç”±**:
- ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã”ã¨ã®æ–‡åŒ–ãƒ»ãƒ‘ã‚¿ãƒ¼ãƒ³ãŒç•°ãªã‚‹
- ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç‰¹åŒ–å‹ãƒ¢ãƒ‡ãƒ«ã‚’ä½œæˆã™ã‚‹å ´åˆ

---

## ğŸ”¬ ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼åŠ¹æœã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³

### ã‚±ãƒ¼ã‚¹1: ãƒœãƒƒãƒˆã‚¢ã‚«ã‚¦ãƒ³ãƒˆé™¤å¤–

```
æ¨å®šåŠ¹æœ:
- é™¤å¤–æ•°: ~50-100äººï¼ˆç·1,379äººã®5-10%ï¼‰
- AUC-ROC ã¸ã®å½±éŸ¿: +1-3%ï¼ˆãƒã‚¤ã‚ºé™¤å»åŠ¹æœï¼‰
```

### ã‚±ãƒ¼ã‚¹2: æœ€å°æ´»å‹•å›æ•°ï¼ˆ5ä»¶ä»¥ä¸Šï¼‰

```
æ¨å®šåŠ¹æœ:
- é™¤å¤–æ•°: ~200-400äººï¼ˆç·1,379äººã®15-30%ï¼‰
- AUC-ROC ã¸ã®å½±éŸ¿: +2-5%ï¼ˆä½å“è³ªãƒ‡ãƒ¼ã‚¿é™¤å»ï¼‰
- ã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚ºæ¸›å°‘: -20-30%
```

### ã‚±ãƒ¼ã‚¹3: ä¸¡æ–¹é©ç”¨

```
æ¨å®šåŠ¹æœ:
- é™¤å¤–æ•°: ~250-500äººï¼ˆç·1,379äººã®18-35%ï¼‰
- AUC-ROC ã¸ã®å½±éŸ¿: +3-7%ï¼ˆè¤‡åˆåŠ¹æœï¼‰
- ãƒ‡ãƒ¼ã‚¿å“è³ª: å¤§å¹…æ”¹å–„
- ã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚º: 879-1,129äººï¼ˆä¾ç„¶ååˆ†ï¼‰
```

---

## ğŸ“ å®Ÿè£…ã‚¬ã‚¤ãƒ‰

### ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼é©ç”¨ã‚¹ã‚¯ãƒªãƒ—ãƒˆä¾‹

```python
# scripts/preprocessing/filter_openstack_data.py
import pandas as pd
from pathlib import Path

def apply_filters(input_csv, output_csv):
    """OpenStackãƒ‡ãƒ¼ã‚¿ã«ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚’é©ç”¨"""
    df = pd.read_csv(input_csv)

    print(f"å…ƒãƒ‡ãƒ¼ã‚¿: {len(df):,}ä»¶, {df['reviewer_email'].nunique()}äºº")

    # 1. ãƒœãƒƒãƒˆã‚¢ã‚«ã‚¦ãƒ³ãƒˆé™¤å¤–
    bot_patterns = ['bot', 'ci', 'automation', 'jenkins', 'build']
    bot_mask = pd.Series([False] * len(df), index=df.index)
    for pattern in bot_patterns:
        bot_mask |= df['reviewer_email'].str.contains(pattern, case=False, na=False)

    df = df[~bot_mask]
    print(f"ãƒœãƒƒãƒˆé™¤å¤–å¾Œ: {len(df):,}ä»¶, {df['reviewer_email'].nunique()}äºº")

    # 2. æœ€å°æ´»å‹•å›æ•°ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
    min_activity = 5
    activity_counts = df['reviewer_email'].value_counts()
    active_reviewers = set(activity_counts[activity_counts >= min_activity].index)

    df = df[df['reviewer_email'].isin(active_reviewers)]
    print(f"æœ€å°æ´»å‹•{min_activity}ä»¶ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼å¾Œ: {len(df):,}ä»¶, {df['reviewer_email'].nunique()}äºº")

    # 3. ä¿å­˜
    df.to_csv(output_csv, index=False)
    print(f"ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼æ¸ˆã¿ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜: {output_csv}")

if __name__ == '__main__':
    apply_filters(
        'data/review_requests_openstack_multi_5y_detail.csv',
        'data/review_requests_openstack_filtered.csv'
    )
```

### ä½¿ç”¨æ–¹æ³•

```bash
# ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼é©ç”¨
uv run python scripts/preprocessing/filter_openstack_data.py

# ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼æ¸ˆã¿ãƒ‡ãƒ¼ã‚¿ã§è¨“ç·´
uv run python scripts/training/irl/train_temporal_irl_sliding_window_fixed_pop.py \
  --reviews data/review_requests_openstack_filtered.csv \
  --snapshot-date 2023-01-01 \
  --reference-period 6 \
  --history-months 12 \
  --target-months 6 \
  --sequence --seq-len 15 --epochs 30 \
  --output importants/irl_filtered_12m_6m
```

---

## ğŸ¯ ã¾ã¨ã‚

### ç¾çŠ¶ã®ç†è§£

1. **ã‚¹ãƒ†ãƒƒãƒ—å˜ä½**: ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒªã‚¯ã‚¨ã‚¹ãƒˆï¼ˆæœ€å°ï¼‰â†’ è»Œè·¡ï¼ˆé›†ç´„ï¼‰â†’ ã‚¨ãƒãƒƒã‚¯ï¼ˆè¨“ç·´ï¼‰
2. **ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼æ¡ä»¶**:
   - å®Ÿæ–½æ¸ˆã¿: åŸºæº–æœŸé–“æ´»å‹•ãªã—ã€å­¦ç¿’æœŸé–“æ´»å‹•ãªã—
   - æœªå®Ÿæ–½: ãƒœãƒƒãƒˆé™¤å¤–ã€æœ€å°æ´»å‹•å›æ•°ã€å¤–ã‚Œå€¤é™¤å¤–
3. **ãƒ‡ãƒ¼ã‚¿å“è³ª**: ãƒœãƒƒãƒˆæ··å…¥ã®å¯èƒ½æ€§ã‚ã‚Š

### æ¨å¥¨ã‚¢ã‚¯ã‚·ãƒ§ãƒ³

#### çŸ­æœŸï¼ˆå„ªå…ˆåº¦é«˜ï¼‰
1. âœ… ãƒœãƒƒãƒˆã‚¢ã‚«ã‚¦ãƒ³ãƒˆé™¤å¤–ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½œæˆ

#### ä¸­æœŸï¼ˆå„ªå…ˆåº¦ä¸­ï¼‰
5. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåˆ¥ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã®æ¤œè¨



---

## ğŸ“š é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- [IRL_COMPREHENSIVE_GUIDE.md](IRL_COMPREHENSIVE_GUIDE.md): IRLå…¨ä½“ã®èª¬æ˜
- [seq_len_explanation.md](seq_len_explanation.md): ã‚·ãƒ¼ã‚±ãƒ³ã‚¹é•·ã®è©³ç´°
- [project_aware_irl_evaluation.md](project_aware_irl_evaluation.md): ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåˆ¥è©•ä¾¡

---

**æœ€çµ‚æ›´æ–°**: 2025-10-17
**ä½œæˆè€…**: Claude + Kazuki-h
**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: åˆç‰ˆå®Œæˆã€ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼å®Ÿè£…å¾…ã¡
